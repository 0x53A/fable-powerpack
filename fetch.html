<!doctype html>
<html class="has-navbar-fixed-top">

<head>
    <title>Fable.PowerPack: Fetch</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /> <link rel="stylesheet" type="text/css" href="http://fable.io/fable-powerpack/main.css"/>
    <link rel="shortcut icon" href="http://fable.io/fable-powerpack/assets/favicon-16x16.png"></link>
</head>

<body>
    <nav class="navbar is-fixed-top is-thoth-primary"><div class="bd-special-shadow" style="opacity:1;transform:scaleY(1)"></div><div class="container"><div class="navbar-brand"><a class="navbar-item" href="http://fable.io/fable-powerpack/index.html"><p class="title is-4">Fable.PowerPack</p></a><a class="navbar-item is-hidden-desktop" href="https://github.com/fable-compiler/fable-powerpack"><span class="icon"><i class="fa  fa-github fa-lg"></i></span></a><a class="navbar-item twitter is-hidden-desktop" href="https://twitter.com/FableCompiler"><span class="icon"><i class="fa  fa-twitter fa-lg"></i></span></a><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu" id="navMenu"><a class="navbar-item" href="http://fable.io/fable-powerpack/date-format.html">Date format</a><a class="navbar-item is-active" href="http://fable.io/fable-powerpack/fetch.html">Fetch</a><a class="navbar-item" href="http://fable.io/fable-powerpack/json.html">Json</a><a class="navbar-item" href="http://fable.io/fable-powerpack/promise.html">Promises</a></div><div class="navbar-end"><a class="navbar-item is-hidden-mobile" href="https://github.com/fable-compiler/fable-powerpack"><span class="icon"><i class="fa  fa-github fa-lg"></i></span></a><a class="navbar-item twitter is-hidden-mobile" href="https://twitter.com/FableCompiler"><span class="icon"><i class="fa  fa-twitter fa-lg"></i></span></a><div class="navbar-item"><div class="field is-grouped"><p class="control"><a class="button twitter" href="https://twitter.com/FableCompiler" target="_blank"><span class="icon"><i class="fa  fa-twitter fa-lg"></i></span><span>Tweet</span></a></p><p class="control"><a class="button github" href="https://github.com/fable-compiler/fable-powerpack"><span class="icon"><i class="fa  fa-github fa-lg"></i></span><span>Github</span></a></p></div></div></div></div></nav>
    <div class="container">
        <div class="content" style="margin: 1rem 0 0">
            <h1><a href="#fetch" aria-hidden="true"><span class="anchor" id="fetch"></span>#</a> Fetch</h1>
<p>Fetch is an API making a request over a network easier than with <code>XMLHttpRequest</code>. It allows you to write your request using the &quot;pipeline&quot; style.</p>
<h2><a href="#access" aria-hidden="true"><span class="anchor" id="access"></span>#</a> Access</h2>
<p>To access the fetch API, you need to use the following <code>open</code> declaration.</p>
<pre><code class="hljs language-fs"><span class="hljs-keyword">open</span> Fable.PowerPack
<span class="hljs-keyword">open</span> Fable.PowerPack.Fetch
</code></pre>
<h2><a href="#basic" aria-hidden="true"><span class="anchor" id="basic"></span>#</a> Basic</h2>
<p>In the next snippet, we are getting the content of the <code>http://fable.io</code> page.</p>
<pre><code class="hljs language-fs">    fetch <span class="hljs-string">"http://fable.io"</span> []
    |&gt; Promise.bind (<span class="hljs-keyword">fun</span> res -&gt; res.text())
    |&gt; Promise.map (<span class="hljs-keyword">fun</span> txt -&gt;
        <span class="hljs-comment">// Access your resource here</span>
        Browser.console.log txt
    )
</code></pre>
<p>We can write the same request using <strong>Promise computation</strong>.</p>
<pre><code class="hljs language-fs">    promise {
        <span class="hljs-keyword">let!</span> res = fetch <span class="hljs-string">"http://fable.io"</span> []
        <span class="hljs-keyword">let!</span> txt = res.text()
        <span class="hljs-comment">// Access your resource here</span>
        Browser.console.log txt
    }
</code></pre>
<h2><a href="#send-a-post-request-with-data" aria-hidden="true"><span class="anchor" id="send-a-post-request-with-data"></span>#</a> Send a POST request with data</h2>
<pre><code class="hljs language-fs">    <span class="hljs-keyword">open</span> Fable.Core.JsInterop

    <span class="hljs-comment">// This is the data we want to send to the server</span>
    <span class="hljs-keyword">let</span> data = {
        Username: <span class="hljs-string">"Maxime"</span>
        Password: <span class="hljs-string">"myPassword"</span>
    }

    <span class="hljs-keyword">let</span> defaultProps =
        [ RequestProperties.Method HttpMethod.POST
        ; requestHeaders [ContentType <span class="hljs-string">"application/json"</span>]
        ; RequestProperties.Body &lt;| unbox(toJson data)]

    promise {
        <span class="hljs-keyword">let!</span> res = fetch <span class="hljs-string">"http://my-server.com/sign-in"</span> defaultProps
        <span class="hljs-keyword">let!</span> txt = res.text()
        <span class="hljs-comment">// Here you got access to the server response</span>
        <span class="hljs-keyword">if</span> txt = <span class="hljs-string">"true"</span> <span class="hljs-keyword">then</span>
            <span class="hljs-comment">// Sign in: OK</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">// Sign in: Failed</span>
    }
</code></pre>
<p>Fable PowerPack already implements some general helpers for you:</p>
<ul>
<li>postRecord: Sends a HTTP POST with the record serialized as JSON.</li>
<li>tryPostRecord: Sends a HTTP POST with the record serialized as JSON and encapsulates it in a <code>Result</code> case.</li>
<li>putRecord: Sends a HTTP PUT with the record serialized as JSON.</li>
<li>etc.</li>
</ul>

        </div>
    </div>
    <div><br/><div class="footer has-text-centered"><div class="container"><div class="content"><p><strong>Fable.PowerPack</strong> by <a href="https://twitter.com/FableCompiler">Fable</a></p>
<p>Powered by <a href="https://mangelmaxime.github.io/Fulma/">Fulma</a> and <a href="https://github.com/fable-compiler/static-page-generator">Fable static-page-generator</a>.</p>
</div></div></div></div>
    <script type="text/javascript">

        document.addEventListener('DOMContentLoaded', function () {

            // Get all "navbar-burger" elements
            var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

            // Check if there are any navbar burgers
            if ($navbarBurgers.length > 0) {

                // Add a click event on each of them
                $navbarBurgers.forEach(function ($el) {
                    $el.addEventListener('click', function () {

                        var $target = document.getElementById("navMenu");

                        // Toggle the class on both the "navbar-burger" and the "navbar-menu"
                        $el.classList.toggle('is-active');
                        $target.classList.toggle('is-active');

                    });
                });
            }

        });

    </script>
</body>

</html>
